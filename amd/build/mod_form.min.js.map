{"version":3,"sources":["../src/mod_form.js"],"names":["define","addServerButton","document","getElementById","missingConfig","getElementsByName","lmsSelectorUrl","systemLanguage","serverController","serverStructure","serverDropDown","init","structure","onchange","courseController","updateOptions","langController","taskController","updateCompleteCourseVisibility","getSelectedServer","selectedServerName","options","selectedIndex","text","i","server","name","disable","disabled","removeChildElems","getAllServers","problemSelectorController","problemSelectorButton","problemSelectorWindow","mumieOrg","value","sendResponse","response","postMessage","JSON","stringify","sendSuccess","message","success","sendFailure","addMessageListener","window","addEventListener","event","origin","importObj","parse","data","setLanguage","language","setSelection","link","setIsGraded","isGraded","focus","displayProblemSelectedMessage","error","require","str","notification","get_strings","component","done","s","addNotification","type","fail","exception","onclick","open","encodeURIComponent","urlprefix","getSelectedLanguage","location","getGradingType","onclose","courseDropDown","coursefileElem","addOptionForCourse","course","optionCourse","createElement","selectedLanguage","languages","includes","setAttribute","append","updateCoursefilePath","getSelectedCourse","coursefile","isEdit","selectedCourseName","courses","j","selectedCourseFile","childElementCount","languageDropDown","languageElem","addLanguageOption","lang","optionLang","setDropDownLanguage","option","languageExists","Error","currentLang","taskSelectionInput","nameElem","taskDisplayElement","useCompleteCourseElem","isGradedElem","updateName","isCustomName","getHeadline","getSelectedTask","length","getAllHeadlines","task","headline","localHeadline","getAllTasks","tasks","m","push","headlines","getPseudoTaskFromCourse","n","getLocalizedLinkFromTask","getLocalizedLink","useCompleteCourse","checked","localizedLink","selectedLink","slice","newSelection","visible","parentElement","style","multiTaskEditController","propertySelectionInputs","selectedTaskProperties","selectedTaskProp","taskSelectionInputs","selectedTasks","selectedTaskIds","sectionInputs","pushIfNotExists","array","element","setTaskSelectionListeners","forEach","checkbox","filter","elem","setPropertySelectionListeners","setSectionSelectionListeners","sectionCheckbox","taskCheckbox","getAttribute","disableDropDownMenus","errorKey","contextid","prbSelectorUrl","serverConfigExists","MumieServer","firstChild","removeChild"],"mappings":"AAAAA,OAAM,sBAAC,CAAC,QAAD,CAAW,gBAAX,CAA6B,oBAA7B,CAAmD,gCAAnD,CAAqF,WAArF,CAAD,CACF,UAAW,IACHC,CAAAA,CAAe,CAAGC,QAAQ,CAACC,cAAT,CAAwB,sBAAxB,CADf,CAEHC,CAAa,CAAGF,QAAQ,CAACG,iBAAT,CAA2B,sBAA3B,EAAmD,CAAnD,CAFb,CAGHC,CAHG,CAIHC,CAJG,CAKHC,CAAgB,CAAI,UAAW,IAC3BC,CAAAA,CAD2B,CAE3BC,CAAc,CAAGR,QAAQ,CAACC,cAAT,CAAwB,WAAxB,CAFU,CAI/B,MAAO,CACHQ,IAAI,CAAE,cAASC,CAAT,CAAoB,CACtBH,CAAe,CAAGG,CAAlB,CACAF,CAAc,CAACG,QAAf,CAA0B,UAAW,CACjCC,CAAgB,CAACC,aAAjB,GACAC,CAAc,CAACD,aAAf,GACAE,CAAc,CAACC,8BAAf,EACH,CACJ,CARE,CASHC,iBAAiB,CAAE,4BAAW,CAC1B,GAAIC,CAAAA,CAAkB,CAAGV,CAAc,CAACW,OAAf,CAAuBX,CAAc,CAACY,aAAtC,EAAqDC,IAA9E,CAEA,IAAK,GAAIC,CAAAA,CAAT,GAAcf,CAAAA,CAAd,CAA+B,CAC3B,GAAIgB,CAAAA,CAAM,CAAGhB,CAAe,CAACe,CAAD,CAA5B,CACA,GAAIC,CAAM,CAACC,IAAP,EAAeN,CAAnB,CAAuC,CACnC,MAAOK,CAAAA,CACV,CACJ,CACD,MAAO,KACV,CAnBE,CAoBHE,OAAO,CAAE,kBAAW,CAChBjB,CAAc,CAACkB,QAAf,IACAC,CAAgB,CAACnB,CAAD,CACnB,CAvBE,CAwBHoB,aAAa,CAAE,wBAAW,CACtB,MAAOrB,CAAAA,CACV,CA1BE,CA4BV,CAhCsB,EALhB,CAuCHsB,CAAyB,CAAI,UAAW,IACpCC,CAAAA,CAAqB,CAAG9B,QAAQ,CAACC,cAAT,CAAwB,qBAAxB,CADY,CAEpC8B,CAFoC,CAGpCC,CAAQ,CAAGhC,QAAQ,CAACG,iBAAT,CAA2B,WAA3B,EAAwC,CAAxC,EAA2C8B,KAHlB,CAWxC,QAASC,CAAAA,CAAT,CAAsBC,CAAtB,CAAgC,CAC5B,GAAI,CAACJ,CAAL,CAA4B,CACxB,MACH,CACDA,CAAqB,CAACK,WAAtB,CAAkCC,IAAI,CAACC,SAAL,CAAeH,CAAf,CAAlC,CAA4D/B,CAA5D,CACH,CAMD,QAASmC,CAAAA,CAAT,EAAmC,IAAdC,CAAAA,CAAc,wDAAJ,EAAI,CAC/BN,CAAY,CAAC,CACTO,OAAO,GADE,CAETD,OAAO,CAAEA,CAFA,CAAD,CAIf,CAMD,QAASE,CAAAA,CAAT,EAAmC,IAAdF,CAAAA,CAAc,wDAAJ,EAAI,CAC/BN,CAAY,CAAC,CACTO,OAAO,GADE,CAETD,OAAO,CAAEA,CAFA,CAAD,CAIf,CAKD,QAASG,CAAAA,CAAT,EAA8B,CAC1BC,MAAM,CAACC,gBAAP,CAAwB,SAAxB,CAAmC,SAACC,CAAD,CAAW,CAC1C,GAAIA,CAAK,CAACC,MAAN,EAAgB3C,CAApB,CAAoC,CAChC,MACH,CACD,GAAI4C,CAAAA,CAAS,CAAGX,IAAI,CAACY,KAAL,CAAWH,CAAK,CAACI,IAAjB,CAAhB,CACA,GAAI,CACApC,CAAc,CAACqC,WAAf,CAA2BH,CAAS,CAACI,QAArC,EACArC,CAAc,CAACsC,YAAf,CAA4BL,CAAS,CAACM,IAAV,CAAiB,QAAjB,CAA4BN,CAAS,CAACI,QAAlE,EACArC,CAAc,CAACwC,WAAf,CAA2BP,CAAS,CAACQ,QAArC,EACAjB,CAAW,GACXK,MAAM,CAACa,KAAP,GACAC,CAA6B,EAChC,CAAC,MAAOC,CAAP,CAAc,CACZjB,CAAW,CAACiB,CAAK,CAACnB,OAAP,CACd,CACF,CAfH,IAgBH,CAKD,QAASkB,CAAAA,CAAT,EAAyC,CACrCE,OAAO,CAAC,CAAC,UAAD,CAAa,mBAAb,CAAD,CAAoC,SAASC,CAAT,CAAcC,CAAd,CAA4B,CACnED,CAAG,CAACE,WAAJ,CAAgB,CAAC,CACb,IAAO,8BADM,CAEbC,SAAS,CAAE,WAFE,CAAD,CAAhB,EAGIC,IAHJ,CAGS,SAASC,CAAT,CAAY,CACjBJ,CAAY,CAACK,eAAb,CAA6B,CACzB3B,OAAO,CAAE0B,CAAC,CAAC,CAAD,CADe,CAEzBE,IAAI,CAAE,MAFmB,CAA7B,CAIH,CARD,EAQGC,IARH,CAQQP,CAAY,CAACQ,SARrB,CASH,CAVM,CAWV,CAED,MAAO,CACH7D,IAAI,CAAE,eAAW,CACbqB,CAAqB,CAACyC,OAAtB,CAAgC,UAAW,CACvCxC,CAAqB,CAAGa,MAAM,CAAC4B,IAAP,CACpBpE,CAAc,6BAAd,CAGM4B,CAHN,CAIM,aAJN,CAKMyC,kBAAkB,CAACnE,CAAgB,CAACW,iBAAjB,GAAqCyD,SAAtC,CALxB,CAMM,eANN,CAOM5D,CAAc,CAAC6D,mBAAf,EAPN,CAQM,UARN,CAQmBF,kBAAkB,CAAC7B,MAAM,CAACgC,QAAP,CAAgB7B,MAAjB,CARrC,CASM,UATN,CASmB1C,CATnB,CAUM,eAVN,CAUwBU,CAAc,CAAC8D,cAAf,EAXJ,CAYlB,QAZkB,CAc3B,CAfD,CAiBAjC,MAAM,CAACkC,OAAP,CAAiB,UAAW,CACxBvC,CAAW,EACd,CAFD,CAIAK,MAAM,CAACC,gBAAP,CAAwB,cAAxB,CAAwC,UAAW,CAC/CN,CAAW,EACb,CAFF,KAIAI,CAAkB,EACrB,CA5BE,CA6BHlB,OAAO,CAAE,kBAAW,CAChBK,CAAqB,CAACJ,QAAtB,GACH,CA/BE,CAiCV,CAhH+B,EAvCzB,CAyJHd,CAAgB,CAAI,UAAW,IAC3BmE,CAAAA,CAAc,CAAG/E,QAAQ,CAACC,cAAT,CAAwB,iBAAxB,CADU,CAE3B+E,CAAc,CAAGhF,QAAQ,CAACG,iBAAT,CAA2B,kBAA3B,EAA+C,CAA/C,CAFU,CAQ/B,QAAS8E,CAAAA,CAAT,CAA4BC,CAA5B,CAAoC,IAC5BC,CAAAA,CAAY,CAAGnF,QAAQ,CAACoF,aAAT,CAAuB,QAAvB,CADa,CAE5BC,CAAgB,CAAGvE,CAAc,CAAC6D,mBAAf,EAFS,CAG5BnD,CAH4B,CAKhC,GAAI,CAAC0D,CAAM,CAACI,SAAP,CAAiBC,QAAjB,CAA0BF,CAA1B,CAAL,CAAkD,CAC9C7D,CAAI,CAAG0D,CAAM,CAAC1D,IAAP,CAAY,CAAZ,CACV,CAFD,IAEO,CACH,IAAK,GAAIF,CAAAA,CAAT,GAAc4D,CAAAA,CAAM,CAAC1D,IAArB,CAA2B,CACvB,GAAI0D,CAAM,CAAC1D,IAAP,CAAYF,CAAZ,EAAe8B,QAAf,EAA2BiC,CAA/B,CAAiD,CAC7C7D,CAAI,CAAG0D,CAAM,CAAC1D,IAAP,CAAYF,CAAZ,CACV,CACJ,CACJ,CACD6D,CAAY,CAACK,YAAb,CAA0B,OAA1B,CAAmChE,CAAI,CAACS,KAAxC,EACAkD,CAAY,CAAC9D,IAAb,CAAoBG,CAAI,CAACS,KAAzB,CACA8C,CAAc,CAACU,MAAf,CAAsBN,CAAtB,CACH,CAKD,QAASO,CAAAA,CAAT,EAAgC,CAC5BV,CAAc,CAAC/C,KAAf,CAAuBrB,CAAgB,CAAC+E,iBAAjB,GAAqCC,UAC/D,CAED,MAAO,CACHnF,IAAI,CAAE,cAASoF,CAAT,CAAiB,CACnBd,CAAc,CAACpE,QAAf,CAA0B,UAAW,CACjC+E,CAAoB,GACpB5E,CAAc,CAACD,aAAf,GACAE,CAAc,CAACC,8BAAf,EACH,CAJD,CAKAJ,CAAgB,CAACC,aAAjB,CAA+BgF,CAAM,CAAGb,CAAc,CAAC/C,KAAlB,GAArC,CACH,CARE,CASH0D,iBAAiB,CAAE,4BAAW,IACtBG,CAAAA,CAAkB,CAAGf,CAAc,CAAC5D,OAAf,CAAuB4D,CAAc,CAAC3D,aAAtC,EAAqDC,IADpD,CAEtB0E,CAAO,CAAGzF,CAAgB,CAACW,iBAAjB,GAAqC8E,OAFzB,CAG1B,IAAK,GAAIzE,CAAAA,CAAT,GAAcyE,CAAAA,CAAd,CAAuB,CACnB,GAAIb,CAAAA,CAAM,CAAGa,CAAO,CAACzE,CAAD,CAApB,CACA,IAAK,GAAI0E,CAAAA,CAAT,GAAcd,CAAAA,CAAM,CAAC1D,IAArB,CAA2B,CACvB,GAAI0D,CAAM,CAAC1D,IAAP,CAAYwE,CAAZ,EAAe/D,KAAf,EAAwB6D,CAA5B,CAAgD,CAC5C,MAAOZ,CAAAA,CACV,CACJ,CACJ,CACD,MAAO,KACV,CArBE,CAsBHzD,OAAO,CAAE,kBAAW,CAChBsD,CAAc,CAACrD,QAAf,IACAC,CAAgB,CAACoD,CAAD,CACnB,CAzBE,CA0BHlE,aAAa,CAAE,wBAAW,CACtB,GAAIoF,CAAAA,CAAkB,CAAGjB,CAAc,CAAC/C,KAAxC,CACAN,CAAgB,CAACoD,CAAD,CAAhB,CACAA,CAAc,CAAC3D,aAAf,CAA+B,CAA/B,CACA,GAAI2E,CAAAA,CAAO,CAAGzF,CAAgB,CAACW,iBAAjB,GAAqC8E,OAAnD,CACA,IAAK,GAAIzE,CAAAA,CAAT,GAAcyE,CAAAA,CAAd,CAAuB,CACnB,GAAIb,CAAAA,CAAM,CAAGa,CAAO,CAACzE,CAAD,CAApB,CACA2D,CAAkB,CAACC,CAAD,CAAlB,CACA,GAAIA,CAAM,CAACU,UAAP,EAAqBK,CAAzB,CAA6C,CACzClB,CAAc,CAAC3D,aAAf,CAA+B2D,CAAc,CAACmB,iBAAf,CAAmC,CACrE,CACJ,CACDR,CAAoB,EACvB,CAvCE,CAyCV,CA3EsB,EAzJhB,CAsOH5E,CAAc,CAAI,UAAW,IACzBqF,CAAAA,CAAgB,CAAGnG,QAAQ,CAACC,cAAT,CAAwB,sBAAxB,CADM,CAEzBmG,CAAY,CAAGpG,QAAQ,CAACC,cAAT,CAAwB,aAAxB,CAFU,CAQ7B,QAASoG,CAAAA,CAAT,CAA2BC,CAA3B,CAAiC,CAC7B,GAAIC,CAAAA,CAAU,CAAGvG,QAAQ,CAACoF,aAAT,CAAuB,QAAvB,CAAjB,CACAmB,CAAU,CAACf,YAAX,CAAwB,OAAxB,CAAiCc,CAAjC,EACAC,CAAU,CAAClF,IAAX,CAAkBiF,CAAlB,CACAH,CAAgB,CAACV,MAAjB,CAAwBc,CAAxB,CACH,CAMD,QAASC,CAAAA,CAAT,CAA6BF,CAA7B,CAAmC,CAC/B,IAAK,GAAIhF,CAAAA,CAAT,GAAc6E,CAAAA,CAAgB,CAAChF,OAA/B,CAAwC,CACpC,GAAIsF,CAAAA,CAAM,CAAGN,CAAgB,CAAChF,OAAjB,CAAyBG,CAAzB,CAAb,CACA,GAAImF,CAAM,CAACxE,KAAP,EAAgBqE,CAApB,CAA0B,CACtBH,CAAgB,CAAC/E,aAAjB,CAAiCE,CAAjC,CACAV,CAAgB,CAACC,aAAjB,GACA,MACH,CACJ,CACJ,CAOD,QAAS6F,CAAAA,CAAT,CAAwBJ,CAAxB,CAA8B,CAC1B,MAAO1F,CAAAA,CAAgB,CAAC+E,iBAAjB,GAAqCL,SAArC,CAA+CC,QAA/C,CAAwDe,CAAxD,CACV,CACD,MAAO,CACH7F,IAAI,CAAE,eAAW,CACb0F,CAAgB,CAACxF,QAAjB,CAA4B,UAAW,CACnCyF,CAAY,CAACnE,KAAb,CAAqBkE,CAAgB,CAAChF,OAAjB,CAAyBgF,CAAgB,CAAC/E,aAA1C,EAAyDC,IAA9E,CACAT,CAAgB,CAACC,aAAjB,GACAE,CAAc,CAACsC,YAAf,EACH,CAJD,CAKAvC,CAAc,CAACD,aAAf,CAA6BC,CAAc,CAAC6D,mBAAf,EAA7B,CACH,CARE,CASHA,mBAAmB,CAAE,8BAAW,CAC5B,MAAOyB,CAAAA,CAAY,CAACnE,KACvB,CAXE,CAYHkB,WAAW,CAAE,qBAASmD,CAAT,CAAe,CACxB,GAAI,CAACI,CAAc,CAACJ,CAAD,CAAnB,CAA2B,CACvB,KAAM,IAAIK,CAAAA,KAAJ,CAAU,iCAAV,CACT,CACDP,CAAY,CAACnE,KAAb,CAAqBqE,CAArB,CACAE,CAAmB,CAACF,CAAD,CACtB,CAlBE,CAmBH7E,OAAO,CAAE,kBAAW,CAChB0E,CAAgB,CAACzE,QAAjB,IACAC,CAAgB,CAACwE,CAAD,CACnB,CAtBE,CAuBHtF,aAAa,CAAE,wBAAW,CACtB,GAAI+F,CAAAA,CAAW,CAAG9F,CAAc,CAAC6D,mBAAf,EAAlB,CACAhD,CAAgB,CAACwE,CAAD,CAAhB,CACAA,CAAgB,CAAC/E,aAAjB,CAAiC,CAAjC,CACA,GAAIkE,CAAAA,CAAS,CAAG1E,CAAgB,CAAC+E,iBAAjB,GAAqCL,SAArD,CACA,IAAK,GAAIhE,CAAAA,CAAT,GAAcgE,CAAAA,CAAd,CAAyB,CACrB,GAAIgB,CAAAA,CAAI,CAAGhB,CAAS,CAAChE,CAAD,CAApB,CACA+E,CAAiB,CAACC,CAAD,CACpB,CACDE,CAAmB,CAACI,CAAD,CACtB,CAjCE,CAmCV,CAzEoB,EAtOd,CAiTH7F,CAAc,CAAI,UAAW,IACzB8F,CAAAA,CAAkB,CAAG7G,QAAQ,CAACG,iBAAT,CAA2B,SAA3B,EAAsC,CAAtC,CADI,CAEzB2G,CAAQ,CAAG9G,QAAQ,CAACC,cAAT,CAAwB,SAAxB,CAFc,CAGzB8G,CAAkB,CAAG/G,QAAQ,CAACC,cAAT,CAAwB,yBAAxB,CAHI,CAIzB+G,CAAqB,CAAGhH,QAAQ,CAACC,cAAT,CAAwB,0BAAxB,CAJC,CAKzBgH,CAAY,CAAGjH,QAAQ,CAACC,cAAT,CAAwB,mBAAxB,CALU,CAW7B,QAASiH,CAAAA,CAAT,EAAsB,CAClB,GAAI,CAACC,CAAY,EAAjB,CAAqB,CACjBL,CAAQ,CAAC7E,KAAT,CAAiBmF,CAAW,CAACrG,CAAc,CAACsG,eAAf,EAAD,CAC/B,CACDN,CAAkB,CAAC9E,KAAnB,CAA2BmF,CAAW,CAACrG,CAAc,CAACsG,eAAf,EAAD,CACzC,CAOD,QAASF,CAAAA,CAAT,EAAwB,CACpB,GAA6B,CAAzB,EAAAL,CAAQ,CAAC7E,KAAT,CAAeqF,MAAnB,CAAgC,CAC5B,QACH,CACD,MAAO,CAACC,CAAe,GAAGhC,QAAlB,CAA2BuB,CAAQ,CAAC7E,KAApC,CACX,CAOD,QAASmF,CAAAA,CAAT,CAAqBI,CAArB,CAA2B,CACvB,GAAI,CAACA,CAAL,CAAW,CACP,MAAO,KACV,CACD,IAAK,GAAIlG,CAAAA,CAAT,GAAckG,CAAAA,CAAI,CAACC,QAAnB,CAA6B,CACzB,GAAIC,CAAAA,CAAa,CAAGF,CAAI,CAACC,QAAL,CAAcnG,CAAd,CAApB,CACA,GAAIoG,CAAa,CAACtE,QAAd,EAA0BtC,CAAc,CAAC6D,mBAAf,EAA9B,CAAoE,CAChE,MAAO+C,CAAAA,CAAa,CAAClG,IACxB,CACJ,CACD,MAAO,KACV,CAOD,QAASmG,CAAAA,CAAT,EAAuB,CACnB,GAAIC,CAAAA,CAAK,CAAG,EAAZ,CACA,IAAK,GAAItG,CAAAA,CAAT,GAAchB,CAAAA,CAAgB,CAACsB,aAAjB,EAAd,CAAgD,CAC5C,GAAIL,CAAAA,CAAM,CAAGjB,CAAgB,CAACsB,aAAjB,GAAiCN,CAAjC,CAAb,CACA,IAAK,GAAI0E,CAAAA,CAAT,GAAczE,CAAAA,CAAM,CAACwE,OAArB,CAA8B,CAC1B,GAAIb,CAAAA,CAAM,CAAG3D,CAAM,CAACwE,OAAP,CAAeC,CAAf,CAAb,CACA,IAAK,GAAI6B,CAAAA,CAAT,GAAc3C,CAAAA,CAAM,CAAC0C,KAArB,CAA4B,CACxB,GAAIJ,CAAAA,CAAI,CAAGtC,CAAM,CAAC0C,KAAP,CAAaC,CAAb,CAAX,CACAD,CAAK,CAACE,IAAN,CAAWN,CAAX,CACH,CACJ,CACJ,CACD,MAAOI,CAAAA,CACV,CAMD,QAASL,CAAAA,CAAT,EAA2B,IACnBQ,CAAAA,CAAS,CAAG,EADO,CAEnBH,CAAK,CAAGD,CAAW,EAFA,CAGvBC,CAAK,CAACE,IAAN,CAAWE,CAAuB,CAACpH,CAAgB,CAAC+E,iBAAjB,EAAD,CAAlC,EACA,IAAK,GAAIrE,CAAAA,CAAT,GAAcsG,CAAAA,CAAd,CAAqB,CACjB,GAAIJ,CAAAA,CAAI,CAAGI,CAAK,CAACtG,CAAD,CAAhB,CACA,IAAK,GAAI2G,CAAAA,CAAT,GAAcT,CAAAA,CAAI,CAACC,QAAnB,CAA6B,CACzBM,CAAS,CAACD,IAAV,CAAeN,CAAI,CAACC,QAAL,CAAcQ,CAAd,EAAiBzG,IAAhC,CACH,CACJ,CACD,GAAI0D,CAAAA,CAAM,CAAGtE,CAAgB,CAAC+E,iBAAjB,EAAb,CACA,IAAK,GAAIK,CAAAA,CAAT,GAAcd,CAAAA,CAAM,CAAC1D,IAArB,CAA2B,CACvB,GAAIA,CAAAA,CAAI,CAAG0D,CAAM,CAAC1D,IAAP,CAAYwE,CAAZ,CAAX,CACA+B,CAAS,CAACD,IAAV,CAAetG,CAAI,CAACS,KAApB,CACH,CACD,MAAO8F,CAAAA,CACV,CAOD,QAASG,CAAAA,CAAT,CAAkCV,CAAlC,CAAwC,CACpC,MAAOW,CAAAA,CAAgB,CAACX,CAAI,CAAClE,IAAN,CAC1B,CAOD,QAAS6E,CAAAA,CAAT,CAA0B7E,CAA1B,CAAgC,CAC5B,MAAOA,CAAAA,CAAI,CAAG,QAAP,CAAkBxC,CAAc,CAAC6D,mBAAf,EAC5B,CAQD,QAASqD,CAAAA,CAAT,CAAiC9C,CAAjC,CAAyC,CACrC,GAAIuC,CAAAA,CAAQ,CAAG,EAAf,CACA,IAAK,GAAInG,CAAAA,CAAT,GAAc4D,CAAAA,CAAM,CAAC1D,IAArB,CAA2B,CACvB,GAAIA,CAAAA,CAAI,CAAG0D,CAAM,CAAC1D,IAAP,CAAYF,CAAZ,CAAX,CACAmG,CAAQ,CAACK,IAAT,CAAc,CACV,KAAQtG,CAAI,CAACS,KADH,CAEV,SAAYT,CAAI,CAAC4B,QAFP,CAAd,CAIH,CACD,MAAO,CACH,KAAQ8B,CAAM,CAAC5B,IADZ,CAEH,SAAYmE,CAFT,CAIV,CAMD,QAASW,CAAAA,CAAT,EAA6B,CACzB,MAAOpB,CAAAA,CAAqB,CAACqB,OAChC,CAED,MAAO,CACH5H,IAAI,CAAE,eAAW,CACbM,CAAc,CAACC,8BAAf,GACAkG,CAAU,GACVF,CAAqB,CAACrG,QAAtB,CAAiC,UAAW,CACxC,GAAIyH,CAAiB,EAArB,CAAyB,CACrB,GAAIE,CAAAA,CAAa,CAAGH,CAAgB,CAACvH,CAAgB,CAAC+E,iBAAjB,GAAqCrC,IAAtC,CAApC,CACAvC,CAAc,CAACsC,YAAf,CAA4BiF,CAA5B,EACAvH,CAAc,CAACwC,WAAf,CAA2B,IAA3B,CACH,CAJD,IAIO,CACHxC,CAAc,CAACwC,WAAf,KACAxC,CAAc,CAACsC,YAAf,CAA4B,IAA5B,CACH,CAED0D,CAAkB,CAACrF,QAAnB,CAA8B,GACjC,CACJ,CAhBE,CAiBH2F,eAAe,CAAE,0BAAW,IACpBkB,CAAAA,CAAY,CAAG1B,CAAkB,CAAC5E,KADd,CAEpBiD,CAAM,CAAGtE,CAAgB,CAAC+E,iBAAjB,EAFW,CAGpBiC,CAAK,CAAG1C,CAAM,CAAC0C,KAAP,CAAaY,KAAb,EAHY,CAIxBZ,CAAK,CAACE,IAAN,CAAWE,CAAuB,CAAC9C,CAAD,CAAlC,EACA,IAAK,GAAI5D,CAAAA,CAAT,GAAcsG,CAAAA,CAAd,CAAqB,CACjB,GAAIJ,CAAAA,CAAI,CAAGI,CAAK,CAACtG,CAAD,CAAhB,CACA,GAAIiH,CAAY,EAAIL,CAAwB,CAACV,CAAD,CAA5C,CAAoD,CAChD,MAAOA,CAAAA,CACV,CACJ,CACD,MAAO,KACV,CA7BE,CA8BHnE,YAAY,CAAE,sBAASoF,CAAT,CAAuB,CACjC,GAAI,CAACA,CAAD,EAAiBL,CAAiB,EAAtC,CAA0C,CACtCK,CAAY,CAAGN,CAAgB,CAACvH,CAAgB,CAAC+E,iBAAjB,GAAqCrC,IAAtC,CAClC,CACDuD,CAAkB,CAAC5E,KAAnB,CAA2BwG,CAA3B,CACAvB,CAAU,EACb,CApCE,CAqCHkB,iBAAiB,CAAE,4BAAW,CAC1B,MAAOA,CAAAA,CAAiB,EAC3B,CAvCE,CAwCHpH,8BAA8B,CAAE,yCAAW,CACvC,GAAI0H,CAAAA,CAAO,CAAG9H,CAAgB,CAAC+E,iBAAjB,GAAqCrC,IAAnD,CACA0D,CAAqB,CAAC2B,aAAtB,CAAoCA,aAApC,CAAkDA,aAAlD,CAAgEC,KAAhE,CACCF,CAAO,CAAG,eAAH,CAAqB,cAChC,CA5CE,CA6CHnF,WAAW,CAAE,qBAASC,CAAT,CAAmB,CAC5B,GAAiB,IAAb,GAAAA,CAAJ,CAAuB,CACnByD,CAAY,CAAChF,KAAb,CAAqB,IACxB,CACDgF,CAAY,CAAChF,KAAb,CAAqBuB,CAAQ,CAAG,GAAH,CAAS,GACzC,CAlDE,CAmDHqB,cAAc,CAAE,yBAAY,CACxB,GAAMrB,CAAAA,CAAQ,CAAGyD,CAAY,CAAChF,KAA9B,CACA,GAAiB,GAAb,GAAAuB,CAAJ,CAAsB,CAClB,MAAO,QACV,CAFD,IAEO,IAAiB,GAAb,GAAAA,CAAJ,CAAsB,CACzB,MAAO,UACV,CACD,MAAO,KACV,CA3DE,CA6DV,CAtMoB,EAjTd,CA0fHqF,CAAuB,CAAI,UAAW,IAClCC,CAAAA,CAAuB,CAAG9I,QAAQ,CAACG,iBAAT,CAA2B,2BAA3B,CADQ,CAElC4I,CAAsB,CAAG/I,QAAQ,CAACG,iBAAT,CAA2B,gCAA3B,EAA6D,CAA7D,CAFS,CAGlC6I,CAAgB,CAAG,EAHe,CAIlCC,CAAmB,CAAGjJ,QAAQ,CAACG,iBAAT,CAA2B,uBAA3B,CAJY,CAKlC+I,CAAa,CAAGlJ,QAAQ,CAACG,iBAAT,CAA2B,sBAA3B,EAAmD,CAAnD,CALkB,CAMlCgJ,CAAe,CAAG,EANgB,CAOlCC,CAAa,CAAGpJ,QAAQ,CAACG,iBAAT,CAA2B,0BAA3B,CAPkB,CAetC,QAASkJ,CAAAA,CAAT,CAAyBC,CAAzB,CAAgCC,CAAhC,CAAyC,CACrC,GAAI,CAACD,CAAK,CAAC/D,QAAN,CAAegE,CAAf,CAAL,CAA8B,CAC1BD,CAAK,CAACxB,IAAN,CAAWyB,CAAX,CACH,CACJ,CAKD,QAASC,CAAAA,CAAT,EAAqC,CACjCP,CAAmB,CAACQ,OAApB,CAA4B,SAASC,CAAT,CAAmB,CAC3CA,CAAQ,CAAC/I,QAAT,CAAoB,UAAW,CAC3B,GAAI,CAAC+I,CAAQ,CAACrB,OAAd,CAAuB,CACnBc,CAAe,CAAGA,CAAe,CAACQ,MAAhB,CAAuB,SAAAC,CAAI,QAAIA,CAAAA,CAAI,EAAIF,CAAQ,CAACzH,KAArB,CAA3B,CACrB,CAFD,IAEO,CACHkH,CAAe,CAACrB,IAAhB,CAAqB4B,CAAQ,CAACzH,KAA9B,CACH,CACDiH,CAAa,CAACjH,KAAd,CAAsBI,IAAI,CAACC,SAAL,CAAe6G,CAAf,CACzB,CACJ,CATD,CAUH,CAKD,QAASU,CAAAA,CAAT,EAAyC,CACrCf,CAAuB,CAACW,OAAxB,CAAgC,SAASC,CAAT,CAAmB,CAC/CA,CAAQ,CAAC/I,QAAT,CAAoB,UAAW,CAC3B,GAAI,CAAC+I,CAAQ,CAACrB,OAAd,CAAuB,CACnBW,CAAgB,CAAGA,CAAgB,CAACW,MAAjB,CAAwB,SAAAC,CAAI,QAAIA,CAAAA,CAAI,EAAIF,CAAQ,CAACzH,KAArB,CAA5B,CACtB,CAFD,IAEO,CACH+G,CAAgB,CAAClB,IAAjB,CAAsB4B,CAAQ,CAACzH,KAA/B,CACH,CACD8G,CAAsB,CAAC9G,KAAvB,CAA+BI,IAAI,CAACC,SAAL,CAAe0G,CAAf,CAClC,CACJ,CATD,CAUH,CAKD,QAASc,CAAAA,CAAT,EAAwC,CACpCV,CAAa,CAACK,OAAd,CAAsB,SAASM,CAAT,CAA0B,CAC5CA,CAAe,CAACpJ,QAAhB,CAA2B,UAAW,CAClC,GAAI,CAACoJ,CAAe,CAAC1B,OAArB,CAA8B,CAC1BY,CAAmB,CAACQ,OAApB,CAA4B,SAASO,CAAT,CAAuB,CAC/C,GAAIA,CAAY,CAACC,YAAb,CAA0B,SAA1B,IAAyCF,CAAe,CAAC9H,KAA7D,CAAoE,CAChE+H,CAAY,CAAC3B,OAAb,IACAc,CAAe,CAAGA,CAAe,CAACQ,MAAhB,CAAuB,SAAAC,CAAI,QAAII,CAAAA,CAAY,CAAC/H,KAAb,EAAsB2H,CAA1B,CAA3B,CACrB,CACJ,CALD,CAMH,CAPD,IAOO,CACHX,CAAmB,CAACQ,OAApB,CAA4B,SAASO,CAAT,CAAuB,CAC/C,GAAIA,CAAY,CAACC,YAAb,CAA0B,SAA1B,IAAyCF,CAAe,CAAC9H,KAA7D,CAAoE,CAChE+H,CAAY,CAAC3B,OAAb,IACAgB,CAAe,CAACF,CAAD,CAAkBa,CAAY,CAAC/H,KAA/B,CAClB,CACJ,CALD,CAMH,CACDiH,CAAa,CAACjH,KAAd,CAAsBI,IAAI,CAACC,SAAL,CAAe6G,CAAf,CACzB,CACJ,CAnBD,CAoBH,CAED,MAAO,CACH1I,IAAI,CAAE,eAAW,CACb+I,CAAyB,GACzBK,CAA6B,GAC7BC,CAA4B,EAC/B,CALE,CAOV,CAtF6B,EA1fvB,CAslBP,QAASI,CAAAA,CAAT,CAA8BC,CAA9B,CAAwC,CACpCvG,OAAO,CAAC,CAAC,UAAD,CAAa,mBAAb,CAAD,CAAoC,SAASC,CAAT,CAAcC,CAAd,CAA4B,CACnED,CAAG,CAACE,WAAJ,CAAgB,CAAC,CACb,IAAQoG,CADK,CAEbnG,SAAS,CAAE,WAFE,CAAD,CAAhB,EAGIC,IAHJ,CAGS,SAASC,CAAT,CAAY,CACjBJ,CAAY,CAACK,eAAb,CAA6B,CACzB3B,OAAO,CAAE0B,CAAC,CAAC,CAAD,CAAD,CAAO,KAAP,CAAehE,CAAa,CAAC+J,YAAd,CAA2B,OAA3B,CAAf,CAAqD,MADrC,CAEzB7F,IAAI,CAAE,SAFmB,CAA7B,CAIH,CARD,EAQGC,IARH,CAQQP,CAAY,CAACQ,SARrB,CASH,CAVM,CAAP,CAWAhE,CAAgB,CAACmB,OAAjB,GACAb,CAAgB,CAACa,OAAjB,GACAX,CAAc,CAACW,OAAf,GACAI,CAAyB,CAACJ,OAA1B,EACH,CAED,MAAO,CACHhB,IAAI,CAAE,cAAS2J,CAAT,CAAoBC,CAApB,CAAoC/D,CAApC,CAA0C,CAC5ClG,CAAc,CAAGiK,CAAjB,CACAhK,CAAc,CAAGiG,CAAjB,CAF4C,GAGxCT,CAAAA,CAAM,CAAG7F,QAAQ,CAACC,cAAT,CAAwB,SAAxB,EAAmCgK,YAAnC,CAAgD,OAAhD,CAH+B,CAIxC1J,CAAe,CAAG8B,IAAI,CAACY,KAAL,CAAWjD,QAAQ,CAACG,iBAAT,CAA2B,wBAA3B,EAAqD,CAArD,EAAwD8B,KAAnE,CAJsB,CAK5C,GAAI4D,CAAM,EAAI,CAACyE,CAAkB,EAAjC,CAAqC,CACjCJ,CAAoB,CAAC,2BAAD,CACvB,CAFD,IAEO,IAAI,CAAC3J,CAAe,CAAC+G,MAArB,CAA6B,CAChC4C,CAAoB,CAAC,2BAAD,CACvB,CAFM,IAEA,CACH5J,CAAgB,CAACG,IAAjB,CAAsBF,CAAtB,EACAK,CAAgB,CAACH,IAAjB,CAAsBoF,CAAtB,EACA9E,CAAc,CAACN,IAAf,CAAoBoF,CAApB,EACA/E,CAAc,CAACL,IAAf,GACAoI,CAAuB,CAACpI,IAAxB,GACAoB,CAAyB,CAACpB,IAA1B,EACH,CACDoI,CAAuB,CAACpI,IAAxB,GACA,GAAIV,CAAJ,CAAqB,CACjB6D,OAAO,CAAC,CAAC,gCAAD,CAAD,CAAqC,SAAS2G,CAAT,CAAsB,CAC9DA,CAAW,CAAC9J,IAAZ,CAAiBV,CAAjB,CAAkCqK,CAAlC,CACH,CAFM,CAGV,CACJ,CAxBE,CAAP,CA+BA,QAASzI,CAAAA,CAAT,CAA0BiI,CAA1B,CAAgC,CAC5B,MAAOA,CAAI,CAACY,UAAZ,CAAwB,CACpBZ,CAAI,CAACa,WAAL,CAAiBb,CAAI,CAACY,UAAtB,CACH,CACJ,CAMD,QAASF,CAAAA,CAAT,EAA8B,CAC1B,MAAuF,EAAhF,GAAAtK,QAAQ,CAACG,iBAAT,CAA2B,sBAA3B,EAAmD,CAAnD,EAAsD8J,YAAtD,CAAmE,OAAnE,CACV,CACJ,CArpBC,CAAN","sourcesContent":["define(['jquery', 'core/templates', 'core/modal_factory', 'auth_mumie/mumie_server_config', 'core/ajax'],\n    function() {\n        var addServerButton = document.getElementById(\"id_add_server_button\");\n        var missingConfig = document.getElementsByName(\"mumie_missing_config\")[0];\n        var lmsSelectorUrl;\n        var systemLanguage;\n        var serverController = (function() {\n            var serverStructure;\n            var serverDropDown = document.getElementById(\"id_server\");\n\n            return {\n                init: function(structure) {\n                    serverStructure = structure;\n                    serverDropDown.onchange = function() {\n                        courseController.updateOptions();\n                        langController.updateOptions();\n                        taskController.updateCompleteCourseVisibility();\n                    };\n                },\n                getSelectedServer: function() {\n                    var selectedServerName = serverDropDown.options[serverDropDown.selectedIndex].text;\n\n                    for (var i in serverStructure) {\n                        var server = serverStructure[i];\n                        if (server.name == selectedServerName) {\n                            return server;\n                        }\n                    }\n                    return null;\n                },\n                disable: function() {\n                    serverDropDown.disabled = true;\n                    removeChildElems(serverDropDown);\n                },\n                getAllServers: function() {\n                    return serverStructure;\n                }\n            };\n        })();\n\n        var problemSelectorController = (function() {\n            var problemSelectorButton = document.getElementById('id_prb_selector_btn');\n            var problemSelectorWindow;\n            var mumieOrg = document.getElementsByName('mumie_org')[0].value;\n\n            /**\n             * Send a message to the problem selector window.\n             *\n             * Don't do anything, if there is no problem selector window.\n             * @param {Object} response\n             */\n            function sendResponse(response) {\n                if (!problemSelectorWindow) {\n                    return;\n                }\n                problemSelectorWindow.postMessage(JSON.stringify(response), lmsSelectorUrl);\n            }\n\n            /**\n             * Send a success message to problem selector window\n             * @param {string} message\n             */\n            function sendSuccess(message = '') {\n                sendResponse({\n                    success: true,\n                    message: message\n                });\n            }\n\n            /**\n             * Send a failure message to problem selector window\n             * @param {string} message\n             */\n            function sendFailure(message = '') {\n                sendResponse({\n                    success: false,\n                    message: message\n                });\n            }\n\n            /**\n             * Add an event listener that accepts messages from LMS-Browser and updates the selected problem.\n             */\n            function addMessageListener() {\n                window.addEventListener('message', (event) => {\n                    if (event.origin != lmsSelectorUrl) {\n                        return;\n                    }\n                    var importObj = JSON.parse(event.data);\n                    try {\n                        langController.setLanguage(importObj.language);\n                        taskController.setSelection(importObj.link + '?lang=' + importObj.language);\n                        taskController.setIsGraded(importObj.isGraded);\n                        sendSuccess();\n                        window.focus();\n                        displayProblemSelectedMessage();\n                    } catch (error) {\n                        sendFailure(error.message);\n                    }\n                  }, false);\n            }\n\n            /**\n             * Display a success message in Moodle that a problem was successfully selected.\n             */\n            function displayProblemSelectedMessage() {\n                require(['core/str', \"core/notification\"], function(str, notification) {\n                    str.get_strings([{\n                        'key': 'mumie_form_updated_selection',\n                        component: 'mod_mumie'\n                    }]).done(function(s) {\n                        notification.addNotification({\n                            message: s[0],\n                            type: \"info\"\n                        });\n                    }).fail(notification.exception);\n                });\n            }\n\n            return {\n                init: function() {\n                    problemSelectorButton.onclick = function() {\n                        problemSelectorWindow = window.open(\n                            lmsSelectorUrl\n                                + '/lms-problem-selector?'\n                                + 'org='\n                                + mumieOrg\n                                + '&serverUrl='\n                                + encodeURIComponent(serverController.getSelectedServer().urlprefix)\n                                + '&problemLang='\n                                + langController.getSelectedLanguage()\n                                + '&origin=' + encodeURIComponent(window.location.origin)\n                                + '&uiLang=' + systemLanguage\n                                + '&gradingType=' + taskController.getGradingType()\n                            , '_blank'\n                        );\n                    };\n\n                    window.onclose = function() {\n                        sendSuccess();\n                    };\n\n                    window.addEventListener(\"beforeunload\", function() {\n                        sendSuccess();\n                     }, false);\n\n                    addMessageListener();\n                },\n                disable: function() {\n                    problemSelectorButton.disabled = true;\n                }\n            };\n        })();\n\n        var courseController = (function() {\n            var courseDropDown = document.getElementById(\"id_mumie_course\");\n            var coursefileElem = document.getElementsByName(\"mumie_coursefile\")[0];\n\n            /**\n             * Add a new option the the 'MUMIE Course' drop down menu\n             * @param {Object} course\n             */\n            function addOptionForCourse(course) {\n                var optionCourse = document.createElement(\"option\");\n                var selectedLanguage = langController.getSelectedLanguage();\n                var name;\n                // If the currently selected server is not available on the server, we need to select another one.\n                if (!course.languages.includes(selectedLanguage)) {\n                    name = course.name[0];\n                } else {\n                    for (var i in course.name) {\n                        if (course.name[i].language == selectedLanguage) {\n                            name = course.name[i];\n                        }\n                    }\n                }\n                optionCourse.setAttribute(\"value\", name.value);\n                optionCourse.text = name.value;\n                courseDropDown.append(optionCourse);\n            }\n\n            /**\n             * Update the hidden input field with the selected course's course file path\n             */\n            function updateCoursefilePath() {\n                coursefileElem.value = courseController.getSelectedCourse().coursefile;\n            }\n\n            return {\n                init: function(isEdit) {\n                    courseDropDown.onchange = function() {\n                        updateCoursefilePath();\n                        langController.updateOptions();\n                        taskController.updateCompleteCourseVisibility();\n                    };\n                    courseController.updateOptions(isEdit ? coursefileElem.value : false);\n                },\n                getSelectedCourse: function() {\n                    var selectedCourseName = courseDropDown.options[courseDropDown.selectedIndex].text;\n                    var courses = serverController.getSelectedServer().courses;\n                    for (var i in courses) {\n                        var course = courses[i];\n                        for (var j in course.name) {\n                            if (course.name[j].value == selectedCourseName) {\n                                return course;\n                            }\n                        }\n                    }\n                    return null;\n                },\n                disable: function() {\n                    courseDropDown.disabled = true;\n                    removeChildElems(courseDropDown);\n                },\n                updateOptions: function() {\n                    var selectedCourseFile = coursefileElem.value;\n                    removeChildElems(courseDropDown);\n                    courseDropDown.selectedIndex = 0;\n                    var courses = serverController.getSelectedServer().courses;\n                    for (var i in courses) {\n                        var course = courses[i];\n                        addOptionForCourse(course);\n                        if (course.coursefile == selectedCourseFile) {\n                            courseDropDown.selectedIndex = courseDropDown.childElementCount - 1;\n                        }\n                    }\n                    updateCoursefilePath();\n                }\n            };\n        })();\n\n        var langController = (function() {\n            var languageDropDown = document.getElementById(\"id_language_dropdown\");\n            var languageElem = document.getElementById(\"id_language\");\n\n            /**\n             * Add a new option to the language drop down menu\n             * @param {string} lang the language to add\n             */\n            function addLanguageOption(lang) {\n                var optionLang = document.createElement(\"option\");\n                optionLang.setAttribute(\"value\", lang);\n                optionLang.text = lang;\n                languageDropDown.append(optionLang);\n            }\n\n            /**\n             * Update the selection of the drop down language with the given lang\n             * @param {string} lang\n             */\n            function setDropDownLanguage(lang) {\n                for (var i in languageDropDown.options) {\n                    var option = languageDropDown.options[i];\n                    if (option.value == lang) {\n                        languageDropDown.selectedIndex = i;\n                        courseController.updateOptions();\n                        return;\n                    }\n                }\n            }\n\n            /**\n             * Check if the given language exists in the currently selected course.\n             * @param {string} lang\n             * @returns {boolean} Whether the language exists\n             */\n            function languageExists(lang) {\n                return courseController.getSelectedCourse().languages.includes(lang);\n            }\n            return {\n                init: function() {\n                    languageDropDown.onchange = function() {\n                        languageElem.value = languageDropDown.options[languageDropDown.selectedIndex].text;\n                        courseController.updateOptions();\n                        taskController.setSelection();\n                    };\n                    langController.updateOptions(langController.getSelectedLanguage());\n                },\n                getSelectedLanguage: function() {\n                    return languageElem.value;\n                },\n                setLanguage: function(lang) {\n                    if (!languageExists(lang)) {\n                        throw new Error(\"Selected language not available\");\n                    }\n                    languageElem.value = lang;\n                    setDropDownLanguage(lang);\n                },\n                disable: function() {\n                    languageDropDown.disabled = true;\n                    removeChildElems(languageDropDown);\n                },\n                updateOptions: function() {\n                    var currentLang = langController.getSelectedLanguage();\n                    removeChildElems(languageDropDown);\n                    languageDropDown.selectedIndex = 0;\n                    var languages = courseController.getSelectedCourse().languages;\n                    for (var i in languages) {\n                        var lang = languages[i];\n                        addLanguageOption(lang);\n                    }\n                    setDropDownLanguage(currentLang);\n                }\n            };\n        })();\n\n        var taskController = (function() {\n            var taskSelectionInput = document.getElementsByName(\"taskurl\")[0];\n            var nameElem = document.getElementById(\"id_name\");\n            var taskDisplayElement = document.getElementById(\"id_task_display_element\");\n            var useCompleteCourseElem = document.getElementById(\"id_mumie_complete_course\");\n            var isGradedElem = document.getElementById('id_mumie_isgraded');\n\n\n            /**\n             * Update the activity's name in the input field\n             */\n            function updateName() {\n                if (!isCustomName()) {\n                    nameElem.value = getHeadline(taskController.getSelectedTask());\n                }\n                taskDisplayElement.value = getHeadline(taskController.getSelectedTask());\n            }\n\n            /**\n             * Check whether the activity has a custom name\n             *\n             * @return {boolean} True, if there is no headline with that name in all tasks\n             */\n            function isCustomName() {\n                if (nameElem.value.length == 0) {\n                    return false;\n                }\n                return !getAllHeadlines().includes(nameElem.value);\n            }\n\n            /**\n             * Get the task's headline for the currently selected language\n             * @param {Object} task\n             * @returns  {string} the headline\n             */\n            function getHeadline(task) {\n                if (!task) {\n                    return null;\n                }\n                for (var i in task.headline) {\n                    var localHeadline = task.headline[i];\n                    if (localHeadline.language == langController.getSelectedLanguage()) {\n                        return localHeadline.name;\n                    }\n                }\n                return null;\n            }\n\n            /**\n             * Get all tasks that are available on all servers\n             *\n             * @return {Object} Array containing all available tasks\n             */\n            function getAllTasks() {\n                var tasks = [];\n                for (var i in serverController.getAllServers()) {\n                    var server = serverController.getAllServers()[i];\n                    for (var j in server.courses) {\n                        var course = server.courses[j];\n                        for (var m in course.tasks) {\n                            var task = course.tasks[m];\n                            tasks.push(task);\n                        }\n                    }\n                }\n                return tasks;\n            }\n\n            /**\n             * Get all possible headlines in all languages\n             * @returns {Object} Array containing all headlines\n             */\n            function getAllHeadlines() {\n                var headlines = [];\n                var tasks = getAllTasks();\n                tasks.push(getPseudoTaskFromCourse(courseController.getSelectedCourse()));\n                for (var i in tasks) {\n                    var task = tasks[i];\n                    for (var n in task.headline) {\n                        headlines.push(task.headline[n].name);\n                    }\n                }\n                var course = courseController.getSelectedCourse();\n                for (var j in course.name) {\n                    var name = course.name[j];\n                    headlines.push(name.value);\n                }\n                return headlines;\n            }\n\n            /**\n             * Add language parameter to the task's link to display content in the selected language\n             * @param {Object} task\n             * @returns {string}\n             */\n            function getLocalizedLinkFromTask(task) {\n                return getLocalizedLink(task.link);\n            }\n\n            /**\n             * Add language parameter to link\n             * @param {string} link\n             * @returns {string}\n             */\n            function getLocalizedLink(link) {\n                return link + \"?lang=\" + langController.getSelectedLanguage();\n            }\n\n\n            /**\n             * Get a task that links to a course's overview page\n             * @param {Object} course\n             * @returns {Object} task\n             */\n            function getPseudoTaskFromCourse(course) {\n                var headline = [];\n                for (var i in course.name) {\n                    var name = course.name[i];\n                    headline.push({\n                        \"name\": name.value,\n                        \"language\": name.language\n                    });\n                }\n                return {\n                    \"link\": course.link,\n                    \"headline\": headline\n                };\n            }\n\n            /**\n             * Returns true, if the user has chosen to select the entire course instead of a single problem\n             * @returns {boolean}\n             */\n            function useCompleteCourse() {\n                return useCompleteCourseElem.checked;\n            }\n\n            return {\n                init: function() {\n                    taskController.updateCompleteCourseVisibility();\n                    updateName();\n                    useCompleteCourseElem.onchange = function() {\n                        if (useCompleteCourse()) {\n                            var localizedLink = getLocalizedLink(courseController.getSelectedCourse().link);\n                            taskController.setSelection(localizedLink);\n                            taskController.setIsGraded(null);\n                        } else {\n                            taskController.setIsGraded(false);\n                            taskController.setSelection(null);\n                        }\n                        // Circumvent moodle bug that ignores \"disabled\" if visibility has changed.\n                        taskDisplayElement.disabled = \"1\";\n                    };\n                },\n                getSelectedTask: function() {\n                    var selectedLink = taskSelectionInput.value;\n                    var course = courseController.getSelectedCourse();\n                    var tasks = course.tasks.slice();\n                    tasks.push(getPseudoTaskFromCourse(course));\n                    for (var i in tasks) {\n                        var task = tasks[i];\n                        if (selectedLink == getLocalizedLinkFromTask(task)) {\n                            return task;\n                        }\n                    }\n                    return null;\n                },\n                setSelection: function(newSelection) {\n                    if (!newSelection && useCompleteCourse()) {\n                        newSelection = getLocalizedLink(courseController.getSelectedCourse().link);\n                    }\n                    taskSelectionInput.value = newSelection;\n                    updateName();\n                },\n                useCompleteCourse: function() {\n                    return useCompleteCourse();\n                },\n                updateCompleteCourseVisibility: function() {\n                    var visible = courseController.getSelectedCourse().link;\n                    useCompleteCourseElem.parentElement.parentElement.parentElement.style =\n                     visible ? \"display:block\" : \"display:none\";\n                },\n                setIsGraded: function(isGraded) {\n                    if (isGraded === null) {\n                        isGradedElem.value = null;\n                    }\n                    isGradedElem.value = isGraded ? '1' : '0';\n                },\n                getGradingType: function () {\n                    const isGraded = isGradedElem.value;\n                    if (isGraded === '1') {\n                        return 'graded';\n                    } else if (isGraded === '0') {\n                        return 'ungraded';\n                    }\n                    return 'all';\n                }\n            };\n        })();\n\n\n        var multiTaskEditController = (function() {\n            var propertySelectionInputs = document.getElementsByName(\"mumie_multi_edit_property\");\n            var selectedTaskProperties = document.getElementsByName(\"mumie_selected_task_properties\")[0];\n            var selectedTaskProp = [];\n            var taskSelectionInputs = document.getElementsByName(\"mumie_multi_edit_task\");\n            var selectedTasks = document.getElementsByName(\"mumie_selected_tasks\")[0];\n            var selectedTaskIds = [];\n            var sectionInputs = document.getElementsByName(\"mumie_multi_edit_section\");\n\n            /**\n             * Push an element to an array, if it's not already included.\n             *\n             * @param {string[]} array\n             * @param {string} element\n             */\n            function pushIfNotExists(array, element) {\n                if (!array.includes(element)) {\n                    array.push(element);\n                }\n            }\n\n            /**\n             * Set selection listeners for other MUMIE Tasks in the course.\n             */\n            function setTaskSelectionListeners() {\n                taskSelectionInputs.forEach(function(checkbox) {\n                    checkbox.onchange = function() {\n                        if (!checkbox.checked) {\n                            selectedTaskIds = selectedTaskIds.filter(elem => elem != checkbox.value);\n                        } else {\n                            selectedTaskIds.push(checkbox.value);\n                        }\n                        selectedTasks.value = JSON.stringify(selectedTaskIds);\n                    };\n                });\n            }\n\n            /**\n             * Set selection listeners for properties to apply to MUMIE Tasks in the course.\n             */\n            function setPropertySelectionListeners() {\n                propertySelectionInputs.forEach(function(checkbox) {\n                    checkbox.onchange = function() {\n                        if (!checkbox.checked) {\n                            selectedTaskProp = selectedTaskProp.filter(elem => elem != checkbox.value);\n                        } else {\n                            selectedTaskProp.push(checkbox.value);\n                        }\n                        selectedTaskProperties.value = JSON.stringify(selectedTaskProp);\n                    };\n                });\n            }\n\n            /**\n             * Set selection listeners for entire section of MUMIE Tasks in the course\n             */\n            function setSectionSelectionListeners() {\n                sectionInputs.forEach(function(sectionCheckbox) {\n                    sectionCheckbox.onchange = function() {\n                        if (!sectionCheckbox.checked) {\n                            taskSelectionInputs.forEach(function(taskCheckbox) {\n                                if (taskCheckbox.getAttribute('section') === sectionCheckbox.value) {\n                                    taskCheckbox.checked = false;\n                                    selectedTaskIds = selectedTaskIds.filter(elem => taskCheckbox.value != elem);\n                                }\n                            });\n                        } else {\n                            taskSelectionInputs.forEach(function(taskCheckbox) {\n                                if (taskCheckbox.getAttribute('section') === sectionCheckbox.value) {\n                                    taskCheckbox.checked = true;\n                                    pushIfNotExists(selectedTaskIds, taskCheckbox.value);\n                                }\n                            });\n                        }\n                        selectedTasks.value = JSON.stringify(selectedTaskIds);\n                    };\n                });\n            }\n\n            return {\n                init: function() {\n                    setTaskSelectionListeners();\n                    setPropertySelectionListeners();\n                    setSectionSelectionListeners();\n                },\n            };\n        })();\n\n        /**\n         *  Disable all dropdown menus and show notification\n         * @param {string} errorKey\n         */\n        function disableDropDownMenus(errorKey) {\n            require(['core/str', \"core/notification\"], function(str, notification) {\n                str.get_strings([{\n                    'key':  errorKey,\n                    component: 'mod_mumie'\n                }]).done(function(s) {\n                    notification.addNotification({\n                        message: s[0] + \"<b>\" + missingConfig.getAttribute(\"value\") + \"</b>\",\n                        type: \"problem\"\n                    });\n                }).fail(notification.exception);\n            });\n            serverController.disable();\n            courseController.disable();\n            langController.disable();\n            problemSelectorController.disable();\n        }\n\n        return {\n            init: function(contextid, prbSelectorUrl, lang) {\n                lmsSelectorUrl = prbSelectorUrl;\n                systemLanguage = lang;\n                var isEdit = document.getElementById(\"id_name\").getAttribute('value');\n                var serverStructure = JSON.parse(document.getElementsByName('mumie_server_structure')[0].value);\n                if (isEdit && !serverConfigExists()) {\n                    disableDropDownMenus('mumie_form_missing_server');\n                } else if (!serverStructure.length) {\n                    disableDropDownMenus('mumie_form_no_server_conf');\n                } else {\n                    serverController.init(serverStructure);\n                    courseController.init(isEdit);\n                    taskController.init(isEdit);\n                    langController.init();\n                    multiTaskEditController.init();\n                    problemSelectorController.init();\n                }\n                multiTaskEditController.init();\n                if (addServerButton) {\n                    require(['auth_mumie/mumie_server_config'], function(MumieServer) {\n                        MumieServer.init(addServerButton, contextid);\n                    });\n                }\n            }\n        };\n\n        /**\n         * Remove all child elements of a given html element\n         * @param {Object} elem\n         */\n        function removeChildElems(elem) {\n            while (elem.firstChild) {\n                elem.removeChild(elem.firstChild);\n            }\n        }\n\n        /**\n         * Check, if the flag for an existing config is set\n         * @returns {boolean}\n         */\n        function serverConfigExists() {\n            return document.getElementsByName(\"mumie_missing_config\")[0].getAttribute(\"value\") === \"\";\n        }\n    });\n"],"file":"mod_form.min.js"}